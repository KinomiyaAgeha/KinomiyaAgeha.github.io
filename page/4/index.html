<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>yozora0908's blog - φ(゜▽゜*)♪</title><meta name="author" content="yozora0908"><meta name="copyright" content="yozora0908"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description"><link rel="shortcut icon" href="/img/4.png"><link rel="canonical" href="https://yozora0908.github.io/page/4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'yozora0908\'s blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-12-14 19:15:50'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/2.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">209</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">80</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://s2.loli.net/2022/12/13/5fHjuPvxm9dwasc.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">yozora0908's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">yozora0908's blog</h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/cf1719-solution/" title="「Codeforces Round」#814 (Div 2)">「Codeforces Round」#814 (Div 2)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-17T03:46:14.000Z" title="发表于 2022-08-17 11:46:14">2022-08-17</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%9E%84%E9%80%A0/">构造</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/Codeforces/">Codeforces</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E8%B4%AA%E5%BF%83/">贪心</a></span></div><div class="content">CF1719.

A. Chip Game
分析
根据 \(n\) 和 \(m\) 的奇偶性判断即可。
CODE
#include&lt;bits/stdc++.h>
using namespace std;
#define int long long
int read() &#123;
	int a=0, f=1; char c=getchar();
	while(!isdigit(c)) &#123;
		if(c=='-') f=-1;
		c=getchar();
	&#125;
	while(isdigit(c)) a=a*10+c-'0', c=getchar();
	return a*f;
&#125;
int t, n, m;
void solve() &#123;
	n=read(), m=read();
	if(m%2==0) &#123;
		if(n%2) puts("Burenka");
		else puts("Tonya");
	&#125; else &#123;
		if(n%2) puts("Tonya");
		else puts("B ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/cf1344e-solution/" title="CF1334E Divisor Paths 题解">CF1334E Divisor Paths 题解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-16T01:21:25.000Z" title="发表于 2022-08-16 09:21:25">2022-08-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%95%B0%E8%AE%BA/">数论</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">组合数学</a></span></div><div class="content">分析
放一张题面里的图。


注意到对于给定的两个点 \((x,y)\)，若
\(x \nmid y\) 并且 \(y \nmid
x\)，那么二者之间的最短路上节点一定是先减小再增加，换句话说，一定是分别从
\(x\) 和 \(y\) 出发，最终汇于一点。否则
对于一条节点大小递减的路径 \((x_1
\rightarrow x_2 \rightarrow \cdots \rightarrow x_n)\)，它的权值为
\(d(x_1) - d(x_2) + d(x_2) - d(x_3) + \cdots -
d(x_n) = d(x_1) -
d(x_n)\)。因此两点之间的路径长度，之和两个端点有关。由于 \((x,y)\)
之间的路径要汇于一点，所以这个点一定是 \((x,y)\) 的公约数 \(z\)，什么时候 \(d(x)- d(z) + d(y) - d(z)\) 最小？\(z = \gcd(x,y)\) 时。
考虑 \((x \rightarrow z)\)
的过程，无论怎样的走法，一定恰好消去了 \(g =
\frac{x}{z}\) ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/lg6278-solution/" title="luogu6278 Haircut 题解">luogu6278 Haircut 题解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-15T13:44:58.000Z" title="发表于 2022-08-15 21:44:58">2022-08-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/">树状数组</a></span></div><div class="content">一道很有趣，也很有益的题目（雾）。

分析
注意到 \(a_i \in
[0,N]\)，这是很关键的一个点，可以从每个 \(a_i\) 下手。
当 \(j= a_i\) 时，所有大于 \(a_i\) 的数都会等于 \(a_i\)。也就是说，所有 \(a_i\)
作为较小数的逆序对，全部寄了。这样看起来很难下手。
可是退一步，当 \(j=a_i\) 时，小于
\(a_i\) 的数不变，大于 \(a_i\) 的数变为 \(a_i\)，它们的相对大小不变。因此，当 \(j=a_i\) 时，由大于 \(a_i\) 的数 \(a_x\) 和小于 \(a_i\) 的数 \(a_y\)，构成的逆序对 \((x,y)\)，其中 \((x&lt;y)\)，此时一定仍然成立。而对于由两个小于
\(a_i\)
的数构成的逆序对，显然也成立。
所以如果以较小数为基准，设 \(S_{a_i}\) 为 \([1,i-1]\) 中大于 \(a_i\) 的数的个数，那么当 \(j \ge a_i\) 时，这些逆序对仍然成立。
而由上述讨论知道，其他的逆序对绝对不成立。
因此，用树状数组求出  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/abc264-solution/" title="「AtCoder Beginner Contest」#264">「AtCoder Beginner Contest」#264</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-15T08:28:55.000Z" title="发表于 2022-08-15 16:28:55">2022-08-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%9B%BE%E8%AE%BA/">图论</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/DP/">DP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/AtCoder/">AtCoder</a></span></div><div class="content">ABC264.

A. "atcoder".substr()
CODE
#include&lt;bits/stdc++.h>
using namespace std;
#define int long long
int read() &#123;
	int a=0, f=1; char c=getchar();
	while(!isdigit(c)) &#123;
		if(c=='-') f=-1;
		c=getchar();
	&#125;
	while(isdigit(c)) a=a*10+c-'0', c=getchar();
	return a*f;
&#125;
signed main() &#123;
	string s="atcoder";
	int l=read()-1, r=read()-1;
	for(;l&lt;=r;++l) printf("%c",s[l]);
	puts("");
&#125;
B. Nice Grid
不会结论，写了大暴力。把行折半之后大力判断。
CODE
#include&lt;bits/stdc++.h>
using ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/cf1712-solution/" title="「Codeforces Round」#813 (Div 2)">「Codeforces Round」#813 (Div 2)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-14T08:36:45.000Z" title="发表于 2022-08-14 16:36:45">2022-08-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%9B%BE%E8%AE%BA/">图论</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E6%9E%84%E9%80%A0/">构造</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/Codeforces/">Codeforces</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E8%B4%AA%E5%BF%83/">贪心</a></span></div><div class="content">CF1712.

A. Wonderful Permutation
分析
考虑到这是个排列，所以最优解一定是把 \(1
\sim k\) 都放在 \([1,k]\)
里面，因此答案是 \([1,k]\) 中满足 \(p_i&gt;k\) 的 \(i\) 的个数。
CODE
#include&lt;bits/stdc++.h>
using namespace std;
#define int long long
int read() &#123;
	int a=0, f=1; char c=getchar();
	while(!isdigit(c)) &#123;
		if(c=='-') f=-1;
		c=getchar();
	&#125;
	while(isdigit(c)) a=a*10+c-'0', c=getchar();
	return a*f;
&#125;
int t, n, k, a[105];
void solve() &#123;
	n=read(), k=read();
	for(int i=1;i&lt;=n;++i) a[i]=read() ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/ncx54f-solution/" title="NowCoderX54F 题解">NowCoderX54F 题解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-14T07:25:01.000Z" title="发表于 2022-08-14 15:25:01">2022-08-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%9B%BE%E8%AE%BA/">图论</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E6%9E%84%E9%80%A0/">构造</a></span></div><div class="content">分析
先给一组官方题解的数据。

10 10
10 19 18 17 16 15 14 13 12 10
先考虑特殊情况，对于每个 \(i\)，要求从 \(1\) 到 \(i\) 再到 \(n\) 的最短路长度为 \(d_i\)。那么当 \(i=1\) 或者 \(i=n\) 时，都相当于 \(1\) 到 \(n\) 的最短路。于是 \(d_1\) 必须等于 \(d_n\)，且二者必须为 \(\min_{i=1}^n{\{
d_i\}}\)，否则一定无解。
于是乎我们就能搞出第一条边。

从 \(1\) 到 \(i\) 再到 \(n\)，一种做法是将 \(i\) 作为一个中转点，单纯地 \(1 \rightarrow i \rightarrow
n\)，另一种做法是 \(1 \rightarrow i
\rightarrow 1 \rightarrow n\)。后者的好处就是，\((1 \rightarrow i)\) 走了两遍，如果 \(d_i - d_1\)
是个偶数，那么这就很好构造了。直接连接 \((1,i)\)，权值为 \(\frac{d_i-d_1}{2 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/ncx54-solution/" title="「NowCoder Round X」#54 题解">「NowCoder Round X」#54 题解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-14T06:35:22.000Z" title="发表于 2022-08-14 14:35:22">2022-08-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DP/">DP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E8%B4%AA%E5%BF%83/">贪心</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/">最短路</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/NowCoder/">NowCoder</a></span></div><div class="content">NowCoderX54.

A. Sum
分析
引理：在最优解中，每次操作的 \(k=2\)。

证明：反证法。假设最优解中，存在一次操作 \(k \neq 2\)。那么 \(k \ge 3\)，当 \(k=3\) 时，设选择的数为 \(a\)，\(b\)，\(c\)，那么会得到 \(a+b+c\)，收益为 \(a+b+c\)。如果先选择 \(a\) 与 \(b\) 得到 \(a+b\)，再选择 \(a+b\) 与 \(c\)，那么会得到 \(a+b+c\)，收益为 \((a+b)+(a+b+c)\)。这与最优解矛盾。由于操作次数没有限制，所以引理显然成立。

引理：在最优解中，一定先选择较大的数，再选择较小的数。

证明：感性理解。如果选择了最大的数和一个正数，那么它被删去之后会在另一个更大数之内，此后只要选这个更大的数，原先最大的数就会不断产生贡献。如果一开始选的数不是最大的数，显然不优。

将数列递减排序，维护前缀和 \(pre\)，对于 \(i
&gt; 1\)，先令 \(pre +
a_i\)，如果此时 \(pre &gt;
0\)，那么累加答案 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/lg6569-6772-solution/" title="luogu6569 &amp; luogu6772 题解">luogu6569 &amp; luogu6772 题解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-12T08:20:22.000Z" title="发表于 2022-08-12 16:20:22">2022-08-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DP/">DP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E7%9F%A9%E9%98%B5/">矩阵</a></span></div><div class="content">luogu6569 魔法值
分析
天数异常大，但是节点数很小，由于异或运算满足结合律，直接考虑矩阵优化。

将初始魔法值搞成一个向量，\(n\) 行
\(1\) 列。 \[
\begin{bmatrix}
w_1
\\
w_2
\\
\vdots
\\
w_n
\end{bmatrix}
\] 考虑转移矩阵 \(A\)。
要达到的目的是，如果 \((i,k)\)
之间有边才进行运算。那么设 \(A_{i,k}\)
表示 \((i,k)\) 是否相连。所以 \[
w&#39;_i = \bigoplus_{k=1}^n A_{i,k} \cdot w_k
\] 所以 \(A_{x,y} = A_{y,x} =
1\)。
好像就没有然后了。
因为有多次询问，直接做的话复杂度是 \(O(qn^3
\log_2 k)\) 的，较高。但是由于不仅做 \(O(n^3)\) 的矩阵乘法，还要做上面那种 \(O(n^2)\)
的矩阵向量乘法，所以可以预处理矩阵次幂，对询问进行二进制拆分优化。
复杂度 \(O(n^3 + qn^2 \log_2
k) ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/abc256g-solution/" title="ABC256G Black and White Stones 题解">ABC256G Black and White Stones 题解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-12T07:53:57.000Z" title="发表于 2022-08-12 15:53:57">2022-08-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DP/">DP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E7%9F%A9%E9%98%B5/">矩阵</a></span></div><div class="content">分析
下面定义白色黑色石头为染白色黑色。
套路性地断环为链。如图中，把顶点拆成两个点，\(i\) 和 \(i&#39;\)，显然 \(i\) 与 \(i&#39;\)
的颜色必定相同，即上一条链的尾等于下一条链的首，所以每条链首尾的颜色都要记录。



枚举每条链防放置石头的个数 \(k\)，设
\(f_{i,0/1,0/1}\) 为考虑前 \(i\)
条链，它们按顺序首尾相连后形成一个长链，其中这个长链的头是黑/白色，尾是黑/白色的方案数。
只有 \(1\) 条链时没有限制，相当于
\(d-1\)
个位置（去掉首尾）染成白色，所以有 \[
\begin{cases}
f_{1,0,0} = C_{d-1}^k
\\
f_{1,0,1} = f_{1,1,0} = C_{d-1}^{k-1}
\\
f_{1,1,1} = C_{d-1}^{k-2}
\end{cases}
\] 考虑将 \(i-1\)
条链相连后，扩展成 \(i\)
条链的过程。一个很重要的思想是，所有的单链，本质上是相同的。
首先，对于 \(f_{i,0,0}\)，必须用 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/abc258-solution/" title="ABC258Ex Odd Steps 题解">ABC258Ex Odd Steps 题解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-08-12T02:51:01.000Z" title="发表于 2022-08-12 10:51:01">2022-08-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/DP/">DP</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E7%9F%A9%E9%98%B5/">矩阵</a></span></div><div class="content">分析
问题可以转化为，在一个 \(1 \sim S\)
的数轴上，把数轴划分成段若干段，每一段的长度必须是奇数，且对于 \(i \in [1,n]\)，不能在 \(a_i\) 处划分。

先不考虑限制条件。
设 \(f_i\) 表示划分 \([1,i]\)，且最后一段是奇数的方案数，设 \(g_i\) 表示划分 \([1,i]\)，且最后一段是偶数的方案数。
考虑 \(i-1 \rightarrow i\)，\(i\) 既可以单独作为一个奇数段，又可以加入
\(i-1\)
所在的这一段，改变这一段的奇偶性，所以 \[
\begin{cases}
f_i = f_{i-1} + g_{i-1}
\\
g_i = f_{i-1}
\end{cases}
\] 答案是 \(f_{S}\)。
\(S\) 过大，考虑矩阵加速递推。
构造向量 \(\begin{bmatrix} f_i \\ g_i
\end{bmatrix}\)，初始为 \(\begin{bmatrix} f_1 = 1 \\ g_1 = 0
\end{bmatrix}\)。 设转移矩阵为 \ ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/3/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/#content-inner">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/#content-inner">21</a><a class="extend next" rel="next" href="/page/5/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/2.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">yozora0908</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">209</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">80</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div><div class="sticky_layout"><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/2-SAT/" style="font-size: 1.1em; color: #999">2-SAT</a> <a href="/tags/2021%E7%9A%84%E5%A4%8F%E5%A4%A9/" style="font-size: 1.14em; color: #999b9d">2021的夏天</a> <a href="/tags/2021%E7%9A%84%E6%9A%91%E5%81%87/" style="font-size: 1.18em; color: #999ca1">2021的暑假</a> <a href="/tags/2022%E7%9A%84%E6%9A%91%E5%81%87/" style="font-size: 1.1em; color: #999">2022的暑假</a> <a href="/tags/AtCoder/" style="font-size: 1.14em; color: #999b9d">AtCoder</a> <a href="/tags/Codeforces/" style="font-size: 1.42em; color: #99a6b7">Codeforces</a> <a href="/tags/DAG/" style="font-size: 1.18em; color: #999ca1">DAG</a> <a href="/tags/DP/" style="font-size: 1.5em; color: #99a9bf">DP</a> <a href="/tags/Floyd/" style="font-size: 1.1em; color: #999">Floyd</a> <a href="/tags/KMP%E7%AE%97%E6%B3%95/" style="font-size: 1.18em; color: #999ca1">KMP算法</a> <a href="/tags/Lucas%E5%AE%9A%E7%90%86/" style="font-size: 1.1em; color: #999">Lucas定理</a> <a href="/tags/Miku/" style="font-size: 1.1em; color: #999">Miku</a> <a href="/tags/NowCoder/" style="font-size: 1.18em; color: #999ca1">NowCoder</a> <a href="/tags/OI/" style="font-size: 1.18em; color: #999ca1">OI</a> <a href="/tags/SOS/" style="font-size: 1.14em; color: #999b9d">SOS</a> <a href="/tags/SPFA/" style="font-size: 1.1em; color: #999">SPFA</a> <a href="/tags/Trie/" style="font-size: 1.18em; color: #999ca1">Trie</a> <a href="/tags/VOCALOID/" style="font-size: 1.1em; color: #999">VOCALOID</a> <a href="/tags/yozora-Round/" style="font-size: 1.3em; color: #99a1ac">yozora Round</a> <a href="/tags/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/" style="font-size: 1.14em; color: #999b9d">中国剩余定理</a> <a href="/tags/%E4%BA%8C%E5%88%86%E5%9B%BE/" style="font-size: 1.3em; color: #99a1ac">二分图</a> <a href="/tags/%E4%BA%8C%E5%88%86%E7%AD%94%E6%A1%88/" style="font-size: 1.34em; color: #99a3b0">二分答案</a> <a href="/tags/%E4%BA%A4%E4%BA%92%E9%A2%98/" style="font-size: 1.1em; color: #999">交互题</a> <a href="/tags/%E5%80%8D%E5%A2%9E/" style="font-size: 1.14em; color: #999b9d">倍增</a> <a href="/tags/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7%E4%BC%98%E5%8C%96/" style="font-size: 1.1em; color: #999">决策单调性优化</a> <a href="/tags/%E5%88%86%E6%95%B0%E8%A7%84%E5%88%92/" style="font-size: 1.14em; color: #999b9d">分数规划</a> <a href="/tags/%E5%88%86%E6%B2%BB/" style="font-size: 1.14em; color: #999b9d">分治</a> <a href="/tags/%E5%8C%BA%E9%97%B4DP/" style="font-size: 1.34em; color: #99a3b0">区间DP</a> <a href="/tags/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/" style="font-size: 1.38em; color: #99a4b4">单调队列</a> <a href="/tags/%E5%8F%8C%E6%8C%87%E9%92%88/" style="font-size: 1.18em; color: #999ca1">双指针</a> <a href="/tags/%E5%8F%8C%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/" style="font-size: 1.1em; color: #999">双连通分量</a> <a href="/tags/%E5%9B%BE%E8%AE%BA/" style="font-size: 1.46em; color: #99a7bb">图论</a> <a href="/tags/%E5%9F%BA%E7%8E%AF%E6%A0%91/" style="font-size: 1.14em; color: #999b9d">基环树</a> <a href="/tags/%E5%A4%B1%E9%85%8D%E6%A0%91/" style="font-size: 1.1em; color: #999">失配树</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 1.26em; color: #999fa8">字符串</a> <a href="/tags/%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86/" style="font-size: 1.18em; color: #999ca1">容斥原理</a> <a href="/tags/%E5%B7%AE%E5%88%86/" style="font-size: 1.1em; color: #999">差分</a> <a href="/tags/%E5%B7%AE%E5%88%86%E7%BA%A6%E6%9D%9F%E7%B3%BB%E7%BB%9F/" style="font-size: 1.14em; color: #999b9d">差分约束系统</a> <a href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" style="font-size: 1.22em; color: #999ea4">并查集</a> <a href="/tags/%E5%BC%BA%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/" style="font-size: 1.18em; color: #999ca1">强连通分量</a></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By yozora0908</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["Sky Arrow"],
      startDelay: 300,
      typeSpeed: 150,
      loop: false,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'Sky Arrow'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script></div></body></html>