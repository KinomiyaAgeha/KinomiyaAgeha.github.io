---
title: 图论β
urls: natsu-GT2
categories: OI
tags: 图论
math: true
abbrlink: 6ed21521
date: 2021-08-01 17:50:39
---

目前我所在的地区还没有太受烟花影响，就下了点小雨

但是这一个月一点作业都没写 qwq，说要换班结果现在都没有消息

今天还要水一篇题解（

好吧 ╮(╯-╰)╭，进入正题

这是一份图论总结

<!--more-->

## 最短路



老生常谈的话题了。。

我们都知道最短路常用的三种算法： Dijkstra，Bellman-Ford，Floyd
其中 Dijkstra 算法是「纯粹的最短路算法」，它基于一个性质，即：当边权都为非负时，全局最小值不可能被其他节点更新，所以可以不断取出全局最小值标记并扩展。这也就导致了，他只能解决广义上可以转化为最短路模型的问题。它有堆优化和桶优化，但都不是本文的重点。

[Roads and Planes ](https://www.luogu.com.cn/problem/P3008)

[有趣的赛车比赛](https://www.luogu.com.cn/problem/UVA12661)

这两题都是正经的「最短路问题」。

而 Bellman-Ford 就有意思得多。我们一般有用它的队列优化形式，也就是那个死掉的 SPFA。它有其他很多用处，~~可惜我不会。~~

SPFA 算法的本质是对队列里的节点，用它能到达的节点对他进行「松弛」操作，使所有节点满足三角形不等式，对应到最短路问题里，就是 设 $d(i)$ 为原点到 $i$ 的最短距离，$E$ 为边集，则有
$$
\large {\forall} (x,y,z) \in E \quad d(y)\le d(x)+z
$$
这像什么？DP！

DP 对状态空间的遍历构成一张 DAG，顺序为该 DAG 的拓扑序。DP无法处理图上最短路问题的原因，是因为图不一定是一张DAG，状态之间有后效性。所以加一维，就可以求出最短路了，将其用滚动数组优化，就是 Bellman-Ford 算法。

这里懒得写了，就放几张 rxz 课件的图。

![](https://i.loli.net/2021/07/31/ktlbg3Ico1ZrmxF.png)



![image.png](https://i.loli.net/2021/07/31/LUaA3o8Hj6lDKOJ.png)





![image.png](https://i.loli.net/2021/07/31/9jcRSEpkbs3VrNX.png)

所以，SPFA 的每一轮松弛操作，对应状态转移。最后，全部的状态收敛，满足三角形不等式（优化后的状态转移方程与三角形不等式不谋而合），所以就求出了答案。

我们回过头来看堆优化 Dijkstra，它实际上近似于「堆优化的 SPFA」，其中也有传奇的三角形不等式。

这启发我们，对于有后效性且不便于加维的 DP，我们可以使用类似最短路的方式进行状态转移。

[骑士游戏](https://www.luogu.com.cn/problem/P4042)

经典的一道题，运用了上述思想。

Dijkstra 和类似拓扑序的顺序也能做，而且复杂度有保证，~~但是不够刺激~~。

看到题解里有人把一本通用来讲述 SPFA 用处的话贴了上来，顿时想起那本不仅大力推崇 SPFA，还花了大量篇幅讲述何种优化方式及用法，~~然而全部都会被卡掉。~~

在这里吐槽一下这本书，通篇宋体，码风奇怪，抄袭，漏洞百出。

就算讲解很敷衍，也坚持把全部代码贴出来。

而且抄袭的部分感觉讲解不完整， ~~没有联系上下文~~，非抄袭的部分思维局限，舍本逐末，讲不到核心的思维。

很多人只知道去建模，只浮于表面。

[Telephone Lines](luogu.com.cn/problem/P1948)

这道题有两种做法。一是用上述 DP 与最短路问题的共通性，建分层图，直接跑最短路。

另一种是二分答案，将不花钱的线看作权为0的边，其余为权为1的边，判断是否可行。

这种情况又有两种做法。

像不像二叉树  \ (￣︶￣*\)) 

一种是使用双端队列 BFS，另一种是在 BFS 时，扩展完一个节点，将其改为未访问的状态

两种方式有细节的不同。

这启发我们，SPFA 是基于 BFS 的算法，其能求解权不为1的图的最短路问题。

最短路问题与 DP，类似拓扑序的奇妙结合，则需要我们自己做题去思考并体会了。

[逛公园](https://www.luogu.com.cn/problem/P3953)  (这题可以看出 pair 的常数之大)

[大陆争霸](luogu.com.cn/problem/P2446)

[雅加达的摩天楼](https://www.luogu.com.cn/problem/solution/P3645) (奇怪的题，~~我还没做~~)

SPFA 还能用来判负环，以及用在分数规划中。具体可以参考我之前的博客。

至于 floyd，我之前的两篇博客都讲得差不多了，，



## 生成树



相信大家对 MST 很了解，这里就不细说概念了。

有两种常用算法 Kruskal 与 Prim。

Kruskal 算法基于贪心，由排序和并查集实现，每次选取权值最小的边加入最小生成树，简单好写。

Prim 算法维护最小生成树的一部分，及 MST 点集 $T$ 和其他点集 $S$，每次找 $\min{_{x \in T,y \in T} \{z\}}$ 这样一条边并加入 $T$，具体实现不作赘述。

感觉这部分没啥好说的，也可能是因为我做题少。

最小生成树上两点的路径就是两点的最小瓶颈路，即路上最大边权最小。

呃……好像就没了。

次小生成树和 kruskal 重构树都没有深入学，仅仅是知道。（~~我连模板题都没切掉~~

随便水一个最短路径生成树吧。

在最短路算法进行的过程中，原点到每个点的最短路径是不断扩展的，而将这些路径加入一个集合，此集合就是一颗最短路径生成树，即所对于边 $(x,y,z)$，有 $d(y)=d(x)+z$

[黑暗城堡](https://loj.ac/p/10064)

对于上题，先跑一遍 Dijkstra，然后执行一个类似于 prim 算法的操作。即维护最短路径生成树的一部分，每扩展一个节点，就判断当前树中有多少节点满足上述条件，并将结果累乘，最终求得答案。

纯粹的生成树问题，要么很难，要么很水，大多数是配合其他算法解决树上图上问题，这里就不放题了。

## 差分约束系统



差分约束系统是 $N$ 元一次不等式组，形如。
$$
\large x_i-x_j\ge c_k \quad i,j \in X
$$
其中 $X$ 是变量集。

当然不等式也可以变成 $x_i-x_j \le c_k$ 这样。

与三角形不等式十分相似。

所以考虑将其与最短路问题相结合。如果把构成差分的两个变量看作节点，不等式的限制看作边与权，那么最短路数组 $d(i)$ 就是满足当前不等式的**约束 **下的 $i$ 的最大值。

据 smy 所言，图论是在线性代数下的课程。

然而我并没有深入理解。。。

而由于这仅仅是一些点之间的关系，直接建图的话图不一定联通，所以有时候需要虚拟原点。还可能隐含一些限制，所以也要注意一些情况，如
$$
\large d(x) \le d(x+1) \le d(x)+1
$$
而这样的题目多是求最大值或最小值，不难想到

对于最大值而言，要使满足形如 $x_i-x_j \le c_k$ 的式子最少，这是显然的

所以跑最短路，图中不应出现负环。

最小值则反之。

[糖果](https://www.luogu.com.cn/problem/P3275)

[Intervals](https://www.luogu.com.cn/problem/SP116)

[倍杀测量者](https://www.luogu.com.cn/problem/P4926)

那么差分约束系统最有意思的地方在哪呢？

当然是 **約束（やくそく）**辣~

[言葉のいらない約束](http://music.163.com/song?id=32235890)



$ キミの背中押す、結んだ約束 $

$ 推动着你前行，我们定下的约定 $





## 一些话



莫名想起去年的暑假

那个没有OI，没有whk，没有被孤立，无忧无虑的暑假

那个曾经被我认为没有意义的暑假

在刷B站，玩游戏，听歌这种循环往复中感受到了夏日透出的清凉

仿佛能蒸融那些鼓吹“竞争”，支持学生内卷的噪音

我还记得那个夏天快要结束的时候

纵使滚滚乌云遮蔽了天空，耳机里的歌声仍然能把我带向更远的地方

然而开学后呢？

”成绩”所带来了虚荣也好，麻烦也罢，彻底毁了我对周围人的信任

发生了很多事，每一次都让我看清那些我曾经当作“朋友”的人的丑恶嘴脸

剩下的，也就只剩那些交情不是很深的阿宅们了……



$  夏の夢に染まっていたいだけ $

$ 想要只做着夏日的梦$ 

 

$ お願いどうか覚めないでよ $

$  拜托了请不要让我醒过来 $



回收初二这一年，一直在逃避，逃避学校内的压力，逃避自己的现状与未来

似乎没有做好一件事



而如今，自己确实走上了自己希望的道路吧。。。

Tommy_Keen，K神的签名大概是

be strong，小伙子，在OI上，你比半年前强了那么多

半年前，1月31日

我最没有方向的时候

一个连 dfs 都不会写的菜鸡，还受到了外界的打击以及胡思乱想给自己的心理压力



前几天的夜晚

那个又迷失了方向的夜晚

“不必在意那些学了好多年的人啊！你一定能超过他们！”

“他们只是时间比我充足啊！”

如是安慰自己

可在晦暗的房间里

回应我的只有氤氲着「嵐（あらし）」气息的风裹挟着的划过眼角的游丝

远处的天空，只有单调的灰黑色

是那么孤独 那么孤独

但愿我能做到吧



耳边响彻的 [夜明けと蛍](http://music.163.com/song?id=33367345)



夏が来ないままの空を描いたなら

/若然幻想出那片夏日仍未到來的天空

君は僕を笑うだろうか

/你大概會取笑我吧

 

明け方の夢

/於拂曉之夢中

浮かぶ月が見えた

/能看見那片浮月之空

 

朝が来ないままで

/若然能永不迎來清晨

息が出来たなら

/如此呼吸生存下去的話

遠い遠い夏の向こうへ

/那就往遙遠 遙遠的 夏日的彼方去

 

冷たくない君の手のひらが見えた

/我並不寒冷 因為能看見你的手心

淡い朝焼けの夜空

/遍染淡淡朝霞的夜空

 

夏がこないままの街を今

/此刻走於這夏日仍未到來的街道上

あぁ 藍の色 夜明けと蛍

啊啊 蒼藍之色 黎明與螢光

 

[IA 版本](http://music.163.com/song?id=30053338)

[鹿乃版本](http://music.163.com/song?id=1302953072)
